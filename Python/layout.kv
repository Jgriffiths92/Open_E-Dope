#:import MDNavigationLayout kivymd.uix.navigationdrawer.MDNavigationLayout
#:import MDNavigationDrawer kivymd.uix.navigationdrawer.MDNavigationDrawer
#:import MDNavigationDrawerMenu kivymd.uix.navigationdrawer.MDNavigationDrawerMenu
#:import MDNavigationDrawerItem kivymd.uix.navigationdrawer.MDNavigationDrawerItem
#:import MDBoxLayout kivymd.uix.boxlayout.MDBoxLayout
#:import MDTopAppBar kivymd.uix.toolbar.MDTopAppBar
#:import MDTextField kivymd.uix.textfield.MDTextField

MDNavigationLayout:
    ScreenManager:
        id: screen_manager
        HomeScreen:
            id: home_screen
            name: "home"  # Name used to navigate to this screen
        SavedCardsScreen:
            id: saved_cards_screen
            name: "saved_cards"  # Name used to navigate to this screen
        ManageDataScreen:
            id: manage_data_screen
            name: "manage_data"  # Name used to navigate to this screen
            
        SettingsScreen:
            id: settings_screen
            name: "settings"  # Name used to navigate to this screen

    MDNavigationDrawer:
        id: drawer
        MDNavigationDrawerMenu:
            MDBoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: "180dp"
                padding: "10dp"

                Image:
                    source: "assets/images/logo.png"
                    size_hint: None, None
                    size: "80dp", "80dp"
                    pos_hint: {"center_x": 0.5}

                MDLabel:
                    text: "Save Dialog Content"
                    text: "Do you want to save the current data?"
                    halign: "center"
                    theme_text_color: "Primary"
                    text: "Open E-Dope"
                    theme_text_color: "Custom"
                    text_color: 0, 0, 0, 1
                    halign: "center"

            MDNavigationDrawerItem:
                text: "Home"
                icon: "home"
                on_release:
                    screen_manager.current = "home"
                    app.root.ids.drawer.set_state("close")

            MDNavigationDrawerItem:
                text: "Saved Cards"
                icon: "content-save"
                on_release:
                    screen_manager.current = "saved_cards"
                    app.root.ids.drawer.set_state("close")

            MDNavigationDrawerItem:
                text: "Manage Data"
                icon: "wrench"
                on_release:
                    screen_manager.current = "manage_data"
                    app.root.ids.drawer.set_state("close")

<HomeScreen>:
    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            title: "Home"
            left_action_items: [["menu", lambda x: app.root.ids.drawer.set_state("open")]]
            right_action_items: [["dots-vertical", lambda x: app.on_dots_press(x)]]
            md_bg_color: 0.678, 0.0, 0.969, 1  
        # Stage Name Text Field
        MDTextField:
            id: stage_name_field
            hint_text: "Stage Name"
            hint_text_mode: "on_focus"
            multiline: False
            halign: "center"
            size_hint_y: None            
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_text_validate: app.on_stage_name_entered(self.text)

        # Table container for displaying the CSV data
        BoxLayout:
            id: table_container  # Placeholder for the table
            orientation: "vertical"
            size_hint: 1, 1
            padding: "10dp"

        # Stage Notes Text Field
        MDTextField:
            id: stage_notes_field
            hint_text: "Stage Notes (e.g., shoot to move/hit to move)"
            hint_text_mode: "on_focus"
            multiline: True
            halign: "center"
            size_hint_y: None
            height: dp(96)  # Limit height to 2 lines (48dp per line)
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_text: app.limit_stage_notes(self)  # Call a method to enforce the line limit
            on_text_validate: app.on_stage_notes_entered(self.text)

        MDFloatingActionButton:
            icon: "content-save"
            md_bg_color: 0.0, 0.969, 0.565, 1
            pos_hint: {"x": 0.9, "y": 0.1}  # Position in the bottom-right corner
            on_release: app.on_fab_press()

<SavedCardsScreen>:
    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            title: "Saved Cards"
            left_action_items: [["menu", lambda x: app.root.ids.drawer.set_state("open")]]
            right_action_items: [["dots-vertical", lambda x: app.on_dots_press(x)]]
            md_bg_color: 0.678, 0.0, 0.969, 1

        MDTextField:
            id: search_field
            hint_text: "Search Cards"
            hint_text_mode: "on_focus"
            multiline: False
            size_hint_y: None            
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            on_text: app.on_search_entered(self.text)

        FileChooserListView:
            id: filechooser
            rootpath: ""  # Placeholder, set dynamically in Python
            filters: []  # Allow all files by default
            on_selection: app.on_file_selected(self.selection)
            size_hint_y: 0.8
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

<ManageDataScreen>:
    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            title: "Manage Data"
            left_action_items: [["menu", lambda x: app.root.ids.drawer.set_state("open")]]
            right_action_items: [["dots-vertical", lambda x: app.on_dots_press(x)]]
            md_bg_color: 0.678, 0.0, 0.969, 1
        MDLabel:
            text: "Manage Data Screen"
            halign: "center"

<SettingsScreen>:
    name: "settings"
    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            title: "Settings"
            left_action_items: [["arrow-left", lambda x: app.switch_to_home()]]
        MDLabel:
            text: "Settings Page"
            halign: "center"

<SettingsScreen>:
    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            title: "Settings"
            left_action_items: [["arrow-left", lambda x: app.navigate_to_home()]]  # Navigate back to Home
            md_bg_color: 0.678, 0.0, 0.969, 1
        MDLabel:
            text: "Settings Page"
<<<<<<< HEAD
            halign: "center"

<SaveDialogContent>:
    MDBoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        size_hint_y: None
        height: dp(200)  # Adjust height to fit all elements
        padding: "20dp"
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1  # Set the color to white
            Rectangle:
                pos: self.pos
                size: self.size

        MDLabel:
            text: "Do you want to save the current data?"
            halign: "center"
            theme_text_color: "Primary"

        MDBoxLayout:
            orientation: "vertical"
            spacing: "10dp"
            size_hint_y: None
            height: dp(48)
            MDDropDownItem:
                id: folder_spinner
                halign: "center"
                text: "Select Folder"
                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                on_release: app.show_folder_dropdown(self)

        MDBoxLayout:
            orientation: "horizontal"
            spacing: "10dp"
            size_hint_y: None
            height: dp(48)

            MDRaisedButton:
                text: "Save"
                md_bg_color: 0.0, 0.969, 0.565, 1
                pos_hint: {"center_y": 0.5, "right": 1}  # Position on the right
                on_release: app.on_save_button_press()

            MDRaisedButton:
                text: "Cancel"
                md_bg_color: 0.969, 0.0, 0.0, 1
                pos_hint: {"center_y": 0.5, "right": 1}  # Position on the right
                on_release: app.dismiss_save_dialog()
=======
            halign: "center"
>>>>>>> parent of c49683b (added dropdown menu in the save dialogue box still need to implement fully)
